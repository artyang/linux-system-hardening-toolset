#!/bin/bash

# Function to look up a vulnerability by CVE
lookup_cve_vulnerability() {
    cve_id="$1"

    echo "Looking up CVE: $cve_id..."
    api_url="https://services.nvd.nist.gov/rest/json/cve/1.0/$cve_id"

    # Make an HTTP request to the NVD API
    response=$(curl -s "$api_url")

    # Check if the request was successful
    if [ -z "$response" ]; then
        echo "Failed to retrieve information for CVE: $cve_id. Please check the CVE ID or try again later."
    else
        # Parse and display relevant information from the response
        description=$(echo "$response" | jq -r '.result.CVE_Items[0].cve.description.description_data[0].value')
        cwe_id=$(echo "$response" | jq -r '.result.CVE_Items[0].cve.problemtype.problemtype_data[0].description[0].value')
        echo "CVE: $cve_id"
        echo "Description: $description"
        echo "CWE ID: $cwe_id"
    fi
}

# Check if the jq command (JSON processor) is installed
if ! command -v jq &>/dev/null; then
    echo "jq command not found. Please install it to use this script."
    exit 1
fi

# Example usage: Pass the CVE ID as an argument to the script
if [ -z "$1" ]; then
    echo "Usage: $0 <CVE_ID>"
else
    lookup_cve_vulnerability "$1"
fi
